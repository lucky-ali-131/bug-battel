<!-- leaderboard.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Leaderboard</title>
  <style>
    body {
      background: #0d0d0d;
      color: #00ffcc;
      font-family: 'Courier New', monospace;
      padding: 20px;
    }
    .container {
      max-width: 600px;
      margin: auto;
      text-align: center;
    }
    ol {
      text-align: left;
      padding-left: 20px;
    }
    li {
      margin-bottom: 5px;
    }
    select {
      background: #111;
      color: #00ffcc;
      border: 1px solid #00ffcc;
      padding: 5px;
      border-radius: 5px;
      margin-bottom: 20px;
    }
  </style>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
</head>
<body>
  <div class="container">
    <h1>Leaderboard</h1>
    <select id="languageSelect" onchange="loadLeaderboard()">
      <option value="python">Python</option>
      <option value="c">C</option>
      <option value="java">Java</option>
      <option value="html">HTML</option>
    </select>
    <ol id="leaderboard"></ol>
    <p id="rankDisplay"></p>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "",
      authDomain: "",
      databaseURL: "",
      projectId: "test-19650",
      storageBucket: "",
      messagingSenderId: "",
      appId: ""
    };
    firebase.initializeApp(firebaseConfig);

    let currentUser;
    firebase.auth().onAuthStateChanged(user => {
      if (user) {
        currentUser = user;
        loadLeaderboard();
      } else {
        window.location.href = 'index.html';
      }
    });

    function loadLeaderboard() {
      const lang = document.getElementById('languageSelect').value;
      firebase.database().ref('users').once('value', snap => {
        const users = [];
        snap.forEach(child => {
          const userData = child.val();
          const langScore = (userData.scores && userData.scores[lang]) || 0;
          users.push({
            id: child.key,
            name: userData.username || "Unnamed",
            score: langScore
          });
        });

        users.sort((a, b) => b.score - a.score);

        const list = document.getElementById('leaderboard');
        list.innerHTML = '';
        users.forEach((user, index) => {
          const li = document.createElement('li');
          li.innerText = `${user.name} - ${user.score}`;
          list.appendChild(li);

          if (user.id === currentUser.uid) {
            document.getElementById('rankDisplay').innerText = `ðŸŽ– Your Rank: #${index + 1}`;
          }
        });
      });
    }
  </script>
</body>
</html>

